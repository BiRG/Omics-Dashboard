{# The dashboard puts resources belonging to the user front and center#}
{% extends "base.html" %}
{% block content %}
<div class="container">
<div class="row form-group">
    <h2> {{ data['name'] }} ({{ type }} {{ data['id'] if 'id' in data else data['rowid'] }})</h2>
    {% if type.lower() == 'collection' %}
    <a href="{{ url_for('download_collection', collection_id=data['id']) }}"
      class="btn btn-primary">
       Download HDF5
        <span class="glyphicon glyphicon-download-alt"></span>
    </a>
    {% elif type.lower() == 'sample' %}
      <a href="{{ url_for('download_sample', sample_id=data['id']) }}"
         class="btn btn-primary">
        Download HDF5
        <span class="glyphicon glyphicon-download-alt"></span>
      </a>
    {% endif %}
</div>
<div class="row">
    <div class="panel panel-primary">
      <div class="panel-heading"><h3>Attributes</h3></div>
    <table id="attributes" class="table table-striped table-bordered" cellspacing="0" width="100%">
      <thead>
        <th>Key</th>
        <th>Value</th>
      </thead>
      <tbody>
      {% for key, value in data.items() %}
      <tr>
        <td>{{ key }}</td>
        {% if key in USERKEYS %}
        <td><a href="{{ url_for('render_user_profile', user_id=value) }}">{{ get_user_name(value) }}</a></td>
        {% elif key=='dateModified' %}
          <td>{{ datetime.utcfromtimestamp(value).strftime('%Y-%m-%d %H:%M:%S (UTC)') }}</td>
        {% else %}
        <td>{{ value }}</td>
        {% endif %}
      </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% if type.lower() == 'sample' or type.lower() == 'collection' %}
<div class="row">
  <div class="panel panel-primary">
  <div class="panel-heading"><h3>Contents</h3></div>
  <table id="datasets" class="table table-striped table-bordered" cellspacing="0" width="100%">
    <thead>
    <tr>
      <th>Path</th>
      <th>HDF5 DType</th>
      <th>Rows</th>
      <th>Columns</th>
      <th>Download</th>
    </tr>
    </thead>
    <tbody>
    {% for dataset in datasets %}
      <tr>
        <td>{{ dataset['path'] }}</td>
        <td>{{ dataset['dtype'] }}</td>
        <td>{{ dataset['rows'] }}</td>
        <td>{{ dataset['cols'] }}</td>
        {% if type.lower() == 'collection' %}
          <td>
            <a class="btn btn-primary"
                    href="{{ url_for('download_collection', collection_id=data['id'], path=dataset['path']) }}">
              Download CSV <span class="glyphicon glyphicon-download-alt"></span>
            </a>
          </td>
        {% else %}
          <td>
            <a class="btn btn-primary"
               href="{{ url_for('download_sample', sample_id=data['id'], path=dataset['path']) }}">
              Download CSV <span class="glyphicon glyphicon-download-alt"></span>
            </a>
          </td>
        {% endif %}
      </tr>
    {% endfor %}
    </tbody>
  </table>
</div>
</div>
{% endif %}
</div>
  </div>
{% endblock %}
